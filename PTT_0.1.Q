[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=205dee88-9b1f-486a-8118-d209ce3d3f50
Description=PTT
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=2
QUI=
[Relative]
SetupOCXFile=
[Comment]

[Attachment]
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


[Script]
ScreenX = Plugin.Sys.GetScRX()
ScreenY = Plugin.Sys.GetScRY()
//����ù���X,Y

Dim f, fso
Set fso = createobject("scripting.FileSystemObject")
Set f = fso.OpenTextFile("C:\user.json")
JsonData = f.ReadAll
Dim sc
Set sc = CreateObject("MSScriptControl.ScriptControl")
sc.Language = "JScript"
sc.AddCode "var json = " & JsonData & ";"
name = sc.Eval("json.name")
pass = sc.Eval("json.pass")
isauto = sc.Eval("json.isauto")
isuserset = sc.Eval("json.isuserset")
//Ū���ϥΪ̳]�w��

Call RunApp("C:\PTT\pietty.exe")
//����PIETTY

Delay 1000
FindPic 0,0,ScreenX,ScreenY,"Attachment:\address.bmp",0.9,intX,intY
If intX > 0 And intY > 0 Then 
	MoveTo intX + 100, intY + 26
	LeftClick 2
	KeyPress "BackSpace", 1
	SayString "bbs@ptt.cc"
	MoveTo intX + 235, intY + 26
	Delay 1000
	LeftClick 2
	KeyPress "BackSpace", 1
	SayString "22"
	Delay 1000
	KeyPress "Enter", 1
End If

Do
	Delay 5000
	Pietty = Plugin.Window.Foreground()
	Pietty = Plugin.Window.GetClass(Pietty)
	Pietty = Plugin.Window.Find(Pietty, 0)
	If Pietty > 0 Then
		Exit Do
	End If
Loop
//����5��,���Pietty����,�Y�����|�@������

//Call Plugin.Window.Max(Pietty)
//�����̤j��

Do
	Delay 5000
	FindPic 0,0,ScreenX,ScreenY,"Attachment:\keyin.bmp",0.9,intX,intY
	If intX > 0 And intY > 0 Then 
		Exit Do
	End If
Loop
//���ݵ����N��

SayString name
KeyPress "Enter", 1
Delay 5000
SayString pass
KeyPress "Enter", 1
//��J�b���K�X

KeyPress "Space", 1
//�����N���~��

Delay 5000
KeyPress "C", 1
KeyPress "Right", 1
//�i�J���հQ�װ�
Delay 5000
//KeyPress "/", 1
//SayString "�Y�ɼ����ݪO"
//KeyPress "Enter", 1
SayString "13"
KeyPress "Enter", 1
Delay 1000
KeyPress "Right", 1
//�i�J����

Randomize
Delaytime = Int((300000 * Rnd) + 1)
//MsgBox "Delaytime-->" & Delaytime
Delay 1000
//�]�w���d�ɶ�,�ü�,�̰�5����

Randomize
Search = Int((20 * Rnd) + 1)
//MsgBox "Search-->" & Search
SayString Search
KeyPress "Enter", 1
Delay 5000
KeyPress "Right", 1
//�i�J�H���ݪO

Do
	Delay 1000
	KeyPress "Space", 1
	Delay 1000
	FindPic 0,0,ScreenX,ScreenY,"Attachment:\S1.bmp",0.9,intX,intY
	If intX > 0 And intY > 0 Then 
		Exit Do
	End If
Loop
//����i�J�峹�ݪO

Select Case isauto
Case 0

	Select Case isuserset
		Case 0
			Do
				Randomize
				Search = Int((50 * Rnd) + 1)
				If Search > 19 Then 
					Comparison = 2
					Comparison = Search mod Comparison
					If Comparison = 1 Then 
						Search = -Search					
					End If
					Exit Do
				End If
			Loop
			//�üƤH��,�׶}19 ~ -19
			
			Delay 2000
			SayString "Z"
			Delay 1000
			SayString Search
			KeyPress "Enter", 1
			Delay 5000
			
			gas = Search
			sum = 0
			Do
				Delay 5000
				Randomize
				Search = Int((24 * Rnd) + 1)
				If sum < 48 Then
					KeyPress "Up", Search
					sum = sum + Search
				Else 
					KeyPress "Down", Search
					sum = sum - Search
				End If
				KeyPress "Right", 1
				Delay 1000
				FindPic 0,0,ScreenX,ScreenY,"Attachment:\S2.bmp",0.9,intX,intY
				If intX > 0 And intY > 0 Then 
					Exit Do
				End If
			Loop
			//�i�J�H���峹,�Y�Q�R��,�N�|�b�H��
			
			Do
				Delay 2000
				KeyPress "Right", 1
				Delay 1000
				FindPic 0,0,ScreenX,ScreenY,"Attachment:\S3.bmp",0.9,intX,intY
				If intX > 0 And intY > 0 Then 
					Exit Do
				End If
			Loop
			//�N�峹���o�H�� 
			
			Delay 5000
			SayString "X"
			Delay 1000
			If gas > 35 Then 
				SayString "1"
			ElseIf gas < -35  Then
				SayString "2"
			Else 
				SayString "3"
			End If
			
			Delay 5000
			SayString " "
			Delay 1000
			KeyPress "Enter", 1
			Delay 1000
			SayString "y"
			KeyPress "Enter", 1
			//��J���Y�T��
		Case 1
		
	End Select
	
	Goto pptend
	//���}���N�\��
Case Else
	sum = 0
	Do
		Delay 5000
		Randomize
		Search = Int((14 * Rnd) + 1)
		If sum < 24 Then
			KeyPress "Up", Search
			sum = sum + Search
		Else 
			KeyPress "Down", Search
			sum = sum - Search
		End If
		KeyPress "Right", 1
		Delay 1000
		FindPic 0,0,ScreenX,ScreenY,"Attachment:\S2.bmp",0.9,intX,intY
		If intX > 0 And intY > 0 Then 
			Exit Do
		End If
	Loop
	//�i�J�H���峹,�Y�Q�R��,�N�|�b�H��

	Do
		Delay 2000
		KeyPress "Right", 1
		Delay 1000
		FindPic 0,0,ScreenX,ScreenY,"Attachment:\S3.bmp",0.9,intX,intY
		If intX > 0 And intY > 0 Then 
			Exit Do
		End If
	Loop
	//�N�峹���o�H��
End Select


Randomize
Delaytime = Int((300000 * Rnd) + 1)
//MsgBox "Delaytime-->" & Delaytime
Delay 1000
//�]�w���d�ɶ�,�ü�,�̰�5����

Do
	KeyPress "Left", 1
	Delay 2000
	FindPic 0,0,ScreenX,ScreenY,"Attachment:\S4.bmp",0.9,intX,intY
	If intX > 0 And intY > 0 Then 
		Exit Do
	End If
Loop

KeyPress "G", 1
KeyPress "Enter", 1
Delay 2000
SayString "y"
KeyPress "Enter", 1
Delay 2000
KeyPress "Space", 1

Rem pptend